#
# MDEV-20016 Add MariaDB_DATA_TYPE_PLUGIN
#
SELECT
PLUGIN_NAME,
PLUGIN_VERSION,
PLUGIN_STATUS,
PLUGIN_TYPE,
PLUGIN_AUTHOR,
PLUGIN_DESCRIPTION,
PLUGIN_LICENSE,
PLUGIN_MATURITY,
PLUGIN_AUTH_VERSION
FROM INFORMATION_SCHEMA.PLUGINS
WHERE PLUGIN_TYPE='DATA TYPE'
    AND PLUGIN_NAME='TEST_INT8';
PLUGIN_NAME	TEST_INT8
PLUGIN_VERSION	1.0
PLUGIN_STATUS	ACTIVE
PLUGIN_TYPE	DATA TYPE
PLUGIN_AUTHOR	MariaDB
PLUGIN_DESCRIPTION	Data type TEST_INT8
PLUGIN_LICENSE	GPL
PLUGIN_MATURITY	Experimental
PLUGIN_AUTH_VERSION	1.0
CREATE TABLE t1 (a TEST_INT8);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `a` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t1;
SELECT CAST('100' AS TEST_INT8) AS cast;
cast
100
BEGIN NOT ATOMIC
DECLARE a TEST_INT8 DEFAULT 256;
SELECT HEX(a), a;
END;
$$
HEX(a)	a
100	256
CREATE FUNCTION f1(p TEST_INT8) RETURNS TEST_INT8 RETURN 1;
SHOW CREATE FUNCTION f1;
Function	sql_mode	Create Function	character_set_client	collation_connection	Database Collation
f1	STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION	CREATE DEFINER=`root`@`localhost` FUNCTION `f1`(p TEST_INT8) RETURNS test_int8
RETURN 1	latin1	latin1_swedish_ci	latin1_swedish_ci
SELECT f1(10);
f1(10)
1
DROP FUNCTION f1;
CREATE TABLE t1 (a TEST_INT8);
CREATE TABLE t2 AS SELECT a FROM t1;
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `a` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
CREATE TABLE t2 AS SELECT COALESCE(a,a) FROM t1;
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `COALESCE(a,a)` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
CREATE TABLE t2 AS SELECT LEAST(a,a) FROM t1;
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `LEAST(a,a)` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
INSERT INTO t1 VALUES (1),(2);
CREATE TABLE t2 AS SELECT MIN(a), MAX(a) FROM t1;
SELECT * FROM t2;
MIN(a)	MAX(a)
1	2
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `MIN(a)` test_int8 DEFAULT NULL,
  `MAX(a)` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (id INT, a TEST_INT8);
INSERT INTO t1 VALUES (1,1),(1,2),(2,1),(2,2);
CREATE TABLE t2 AS SELECT id, MIN(a), MAX(a) FROM t1 GROUP BY id;
SELECT * FROM t2;
id	MIN(a)	MAX(a)
1	1	2
2	1	2
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `id` int(11) DEFAULT NULL,
  `MIN(a)` test_int8 DEFAULT NULL,
  `MAX(a)` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
INSERT INTO t1 VALUES (1),(2);
CREATE TABLE t2 AS SELECT DISTINCT a FROM t1;
SELECT * FROM t2;
a
1
2
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `a` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
INSERT INTO t1 VALUES (1);
CREATE TABLE t2 AS SELECT (SELECT a FROM t1) AS c1;
SELECT * FROM t2;
c1
1
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `c1` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
CREATE TABLE t1 (a TEST_INT8);
CREATE TABLE t2 AS SELECT a FROM t1 UNION SELECT a FROM t1;
SHOW CREATE TABLE t2;
Table	Create Table
t2	CREATE TABLE `t2` (
  `a` test_int8 DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1
DROP TABLE t2;
DROP TABLE t1;
