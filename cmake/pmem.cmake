INCLUDE(CheckIncludeFiles)
OPTION(WITH_PMEMAC "Enable persistent memory append cache" OFF)
IF(WITH_PMEMAC)
  FIND_LIBRARY(LIBPMEM pmem)
  CHECK_INCLUDE_FILES(libpmem.h HAVE_LIBPMEM_H)
  IF (NOT LIBPMEM)
    MESSAGE(FATAL_ERROR "Can't find libpmem")
  ELSEIF(NOT HAVE_LIBPMEM_H)
    MESSAGE(FATAL_ERROR "Can't find libpmem.h")
  ELSE()
    INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/extra/libpmemac)
    ADD_DEFINITIONS(-DHAVE_PMEMAC)
    SET(LIBPMEMAC "pmemac")
  ENDIF()
ENDIF()
